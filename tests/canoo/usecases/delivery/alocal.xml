<?xml version="1.0"?>
<!DOCTYPE project SYSTEM                    "../../includes/WebTest.dtd" [
  <!ENTITY config SYSTEM               "file:../../includes/config.xml">
  <!ENTITY checkForErrors SYSTEM       "file:../../modules/errors.xml">
  <!ENTITY verifyLinks SYSTEM          "file:../../modules/links.xml">
]
>

<!-- Test that delivery shows a proper ad for different requests (zone, bannerid, etc) -->

<project name="Openads delivery - afr.php" basedir="../.." default="main">
  <import file="../../includes/init.xml"/>
  <import file="${webtest.home}/lib/taskdef.xml"/>

  <target name="main">
    <!-- additional preparation - copy alocal.php into www folder -->
    <copy file="php/alocal.php" todir="../../www" />
    
    <testSpec name="Run Delivery">
      &config;
      <steps>
        <invoke description="Invoke delivery file" url="alocal.php" />
        &checkForErrors;
        <verifyText description="Check that image is included" regex="true" text="img src=.*ai.php" />
        &verifyLinks;
      </steps>

    </testSpec>

    <!-- remove copied file after testing it -->
    <delete file="../www/alocal.php" />
</target>

</project>