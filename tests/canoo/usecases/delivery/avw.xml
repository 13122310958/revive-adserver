<?xml version="1.0"?>
<!DOCTYPE project SYSTEM                    "../../includes/WebTest.dtd" [
  <!ENTITY config SYSTEM               "file:../../includes/config.xml">
  <!ENTITY checkForErrors SYSTEM       "file:../../modules/errors.xml">
  <!ENTITY checkDeliveryCookies SYSTEM "file:../../modules/cookies.xml">
  <!ENTITY checkForImageGif SYSTEM     "file:../../modules/gif.xml">
]
>

<!--
  Test that page redirects user to ai.php
-->
<project name="Openads delivery - avw.php" basedir="../.." default="main">
  <import file="../../includes/init.xml"/>
  <import file="${webtest.home}/lib/taskdef.xml"/>

  <target name="canoo-test">
    <testSpec name="Run Delivery">
      &config;
      <steps>
        <invoke description="Invoke delivery file" url="/delivery/avw.php?bannerid=3" />
        &checkForErrors;
        &checkDeliveryCookies;
        <!-- Check that browser was redirected to ai.php file and that response contains gif -->
        &checkForImageGif;
      </steps>
    </testSpec>
  </target>

  <!-- clean cache, run a canoo test (without cache), and do again (with cache) -->
  <target name="main" depends="clean-delivery-cache, canoo-test, canoo-test" />
  
</project>